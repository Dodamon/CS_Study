# 네트워크를 이루는 장치  #1 애플리케이션 계층

## 애플리케이션 계층

- 애플리케이션은 FTP, HTTP, SSH, SMTP, DNS등 응용 프로그램이 사용되는 프로토콜 계층이며, 웹 서비스, 이메일 등 서비스를 실질적으로 사람들에게 제공하는 층이다

## L7스위치

- 스위치는 여러 장비를 연결하고 데이터 통신을 중재하며 목적지가 연결된 포트로만 전기 신호를 보내 데이터를 전송하는 통신 네트워크 장비이다.
- L7(layer 7)스위치는 `로드밸런서`라고도 하며, 서버의 부하를 분산하는 기기이다. 클라이언트로부터 오는 요청들을 뒤쪽의 여러 서버로 나누는 역할을 하며 시스템이 처리할 수 잇는 트래픽 증가를 목표로 한다.
- URL,서버,캐시,쿠키들을 기반으로 트래픽을 분산한다. 또한 바이러스, 불필요한 외부 데이터 등을 걸러내는 필터링 기능 또한 가지고 있으며 응용 프로그램 수준의 트래픽 모니터링도 가능하다.
- 만약 장애가 발생한 서버가 있다면 이를 트래픽 분산 대상에서 제외해아 하는데, 이는 정기적으로 헬스 체크(Health Check)를 이용하여 감시하면서 이루어진다.
    - **헬스 체크**:  L4 스위치 또는 L7스위치 모두 헬스 체크를 통해 정상적인 서버 또는 비정상적인 서버를 판별하는데, 헬스 체크는 전송 주기와 재전송 횟수 등을 설정한 이후 반복적으로 서버에 요청을 보내는 것을 말한다. 예를들어 TCP요청을 보냈는데 3-WAY HANDSHAKE가 정상적으로 일어나지 않았다면 정상이 아닌 경우이다.

## 로드밸런서를 이용한 서버 이중화

- 로드밸런서의 대표적인 기능으로 **서버 이중화**를 들 수 있다. 서비스를 안정적으로 운용하기 위해서는 2대 이상의 서버가 필수적이다. 에러가 발생하여 서버 1대가 종료되더라도, 서비스는 안정적으로 운용되어야 하기 때문이다.
- 로드밸런서는 2대 이상의 서버를 기반으로 가상 IP를 제공하고 이를 기반으로 안정적인 서비스를 제공한다.
- 다음 그림처럼 로드 밸런서가 제공한 0.0.0.12010이란 가상 IP에 사용자들이 접근하고, 뒷단에 사용가능항 서버인 0.0.0.12011과 0.0.0.12012를 기반으로 서빙한다. 이렇게하면 0.0.0.12011이란 서버에 장애가 발생해도 그것과는 무방하게 0.0.0.12012서버를 기반으로 안정적인 서비스를 운용할 수 있다.
- 이외에도 클라이언트가 호스트에 직접 접촉하는 것을 방지하여 내부 네트워크 구조를 숨기고 클라이언트가 호스트와 직접 상호작용하는 것을 방지하는 **보안 이점**이 잇다.
- 참고로 클라우드 서비스(AWS)등에서 L7스위치를 이용한 로드밸런싱은 ALB(Application Load Balancer)컴포넌트로 하며, L4스위치를 이용한 로드밸런싱은 NLB(Network Load Balancer)컴포넌트로 한다.

<img src="https://user-images.githubusercontent.com/80434024/209550346-6882bd01-07ae-40e3-a40c-a5ac241a526a.png"/>